<div *ngIf="projectsData && projectsData.length === 0 && !isLoading">
  <h3>{{ errorMessage }}</h3>
</div>
<div class="grid-container">
  <article class="card" *ngFor="let project of getPaginatedProjects()" (click)="navigateToProjectDetails(project.id)">
    <section class="card-content">
      <div class="header-section">
        <header class="title-wrapper">
          <h1 [title]="project.title">{{ project.truncatedTitle }}</h1>
          <img src="assets\project-preview\more.svg" alt=""/>
          <img src="assets\project-preview\edit.svg" alt="" (click)="openEditOverlay($event)" />
        </header>
        <span class="status-label" [ngClass]="{
          'ready': project.stateId === 2,
          'in-progress': project.stateId === 3,
          'done': project.stateId === 5,
          'not-started': project.stateId === 1,
          'cancelled': project.stateId === 6,
          'blocked': project.stateId === 4
        }">{{project.stateName}}</span>
      </div>
      <hr class="divider" />
      <p class="description" [title]="project.description">{{ project.truncatedDescription }}</p>
      <div class="date-section">
        <img src="assets\project-preview\time.svg" alt="" />
        <time *ngIf="project.end">{{ project.end | date: 'dd MMMM yyyy' }}</time>
      </div>
      <div class="issue-section">
        <!-- Team members -->
        <div class="team-members" *ngIf="project">
          <ng-container *ngFor="let imageUrl of getTeamMemberImages(project).slice(0, 4); let i = index">
            <img class="team-member" [src]="imageUrl" [alt]="'Team Member ' + (i+1)" [style.left.px]="i * 20" />
          </ng-container>
          <div *ngIf="getTeamMemberImages(project).length > 4" class="additional-members">
            +{{ getTeamMemberImages(project).length - 4 }}
          </div>
        </div>

        <div class="issue-details">
          <img src="assets\project-preview\issues.svg" alt=""/>
          {{ project.assignmentCount === 0 ? 'No issues' : (project.assignmentCount === 1 ? '1 issue' : project.assignmentCount + ' issues') }}
        </div>
      </div>
    </section>
  </article>
</div>

<!-- Kontrole paginacije -->
<div class="pagination-container" [ngClass]="{'bottom': shouldShowBottomPagination()}">
  <div class="pagination-controls">
    <span class="pagination-text-prev" (click)="previousPage()" [class.disabled]="currentPage === 1" [style.visibility]="currentPage === 1 ? 'hidden' : 'visible'">Previous</span>
    <ng-container *ngFor="let page of pagesToShow()">
      <button class="pagination-page" (click)="goToPage(page)" [class.active]="currentPage === page">{{ page }}</button>
      <span class="pagination-space"></span>
    </ng-container>
    <span class="pagination-text" (click)="nextPage()" [class.disabled]="currentPage === totalPages()" [style.visibility]="shouldShowBottomPagination() ? 'visible' : 'hidden'">Next</span>
  </div>
</div>
